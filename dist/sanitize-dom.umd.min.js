(function (global, factory) {
	typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :
	typeof define === 'function' && define.amd ? define(['exports'], factory) :
	(factory((global.sanitizeDom = {})));
}(this, (function (exports) { 'use strict';

function sanitizeDom(a,b){var q=2<arguments.length&&arguments[2]!==void 0?arguments[2]:'node',r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:{};function c(a){var b=u[a];return b||(b=new RegExp('^'+a+'$','g'), u[a]=b), b}function d(a,b){var d=Object.getOwnPropertyNames(a),e=[],f=!0,g=!1,h=void 0;try{for(var i,j=d[Symbol.iterator]();!(f=(i=j.next()).done);f=!0){var k=i.value,l=c(k);b.match(l)&&(e=e.concat(a[k]));}}catch(a){g=!0, h=a;}finally{try{!f&&j.return&&j.return();}finally{if(g)throw h}}return e}function e(a,b){var e=d(a,b),f=e.map(function(a){return c(a)});return f}function f(a,b,c){return e(a,b).some(function(a){return null!=c.match(a)})}function g(a){var b=[],c=!0,d=!1,e=void 0;try{for(var f,g,h=a.childNodes[Symbol.iterator]();!(c=(f=h.next()).done);c=!0)g=f.value, b.push(g);}catch(a){d=!0, e=a;}finally{try{!c&&h.return&&h.return();}finally{if(d)throw e}}return b}function h(a,b){var c=!0,d=!1,e=void 0;try{for(var f,g,h=b[Symbol.iterator]();!(c=(f=h.next()).done);c=!0)g=f.value, a.parentNode.insertBefore(g,a);}catch(a){d=!0, e=a;}finally{try{!c&&h.return&&h.return();}finally{if(d)throw e}}a.remove();}function i(a,b){var c=!1,d=a.sanitize_skip_filters;if(delete a.sanitize_skip_filters, d)return!1;var e=[],f=!0,g=!1,i=void 0;try{for(var j,k=b[Symbol.iterator]();!(f=(j=k.next()).done);f=!0){var u=j.value,v=u(a,s,t);if(v===a){var w=a.sanitize_skip_filters;if(delete a.sanitize_skip_filters, w)break;else continue}else v instanceof Array?(h(a,v), c=!0, e=e.concat(v)):v?(a.parentNode.replaceChild(v,a), c=!0, e.push(v)):(a.remove(), c=!0);var l=!0,m=!1,n=void 0;try{for(var p,q,r=e[Symbol.iterator]();!(l=(p=r.next()).done);l=!0){if(q=p.value, q.nodeName==a.nodeName&&'undefined'==typeof q.sanitize_skip_filters)throw new Error('Prevented possible infinite loop. Filter function \''+(u.prototype.constructor.name||'anonymous')+'\' has returned a node of type \''+q.nodeName+'\' which has the same nodeName as the original node. This can lead to an infinite loop if the filter always returns the same result. To get rid of this warning, the filter must set the property \'sanitize_skip_filters\' on the returned node (evaluating to true or false) to signal if the returned node is to be sanitized again (false) or not (true).');o(q);}}catch(a){m=!0, n=a;}finally{try{!l&&r.return&&r.return();}finally{if(m)throw n}}break}}catch(a){g=!0, i=a;}finally{try{!f&&k.return&&k.return();}finally{if(g)throw i}}return c}function j(a){var b=[],c=!0,d=!1,e=void 0;try{for(var g,h,i=a.classList[Symbol.iterator]();!(c=(g=i.next()).done);c=!0)h=g.value, b.push(h);}catch(a){d=!0, e=a;}finally{try{!c&&i.return&&i.return();}finally{if(d)throw e}}var j=!0,k=!1,l=void 0;try{for(var m,n=b[Symbol.iterator]();!(j=(m=n.next()).done);j=!0){var o=m.value,p=f(r.allow_classes_by_tag,a.nodeName,o);if(!p){a.classList.remove(o);continue}}}catch(a){k=!0, l=a;}finally{try{!j&&n.return&&n.return();}finally{if(k)throw l}}a.hasAttribute('class')&&0===a.classList.length&&a.attributes.removeNamedItem('class');}function k(a){for(var b,c=0;c<a.attributes.length;c++)if(b=a.attributes[c].name, 'class'!=b&&!f(r.allow_attributes_by_tag,a.nodeName,b)){a.attributes.removeNamedItem(b);continue}}function l(b){var d=a.createDocumentFragment(),e=!0,f=!1,h=void 0;try{for(var i,j,c=g(b)[Symbol.iterator]();!(e=(i=c.next()).done);e=!0)j=i.value, d.appendChild(j);}catch(a){f=!0, h=a;}finally{try{!e&&c.return&&c.return();}finally{if(f)throw h}}return d}function m(a){var b=l(a);p(b), a.parentNode.insertBefore(b,a), a.remove();}function n(a,b){for(var r=g(a),s=0;s<r.length;s++){var i=r[s],t=r[s+1],u=r[s+2];if(t&&i.nodeName==t.nodeName&&b.includes(i.nodeName)&&b.includes(t.nodeName)){var d=!0,e=!1,f=void 0;try{for(var h,j,c=g(t)[Symbol.iterator]();!(d=(h=c.next()).done);d=!0)j=h.value, i.appendChild(j);}catch(a){e=!0, f=a;}finally{try{!d&&c.return&&c.return();}finally{if(e)throw f}}return t.remove(), void n(a,b)}if(t&&u&&i.nodeName==u.nodeName&&3==t.nodeType&&t.textContent.match(/^\s+$/)&&b.includes(u.nodeName)){i.appendChild(t);var k=!0,l=!1,m=void 0;try{for(var o,p,q=g(u)[Symbol.iterator]();!(k=(o=q.next()).done);k=!0)p=o.value, i.appendChild(p);}catch(a){l=!0, m=a;}finally{try{!k&&q.return&&q.return();}finally{if(l)throw m}}return u.remove(), void n(a,b)}}}function o(a){if(a.sanitize_skip)return void delete a.sanitize_skip;var b=a.nodeName;3==a.nodeType&&(b='TEXT');var c=d(r.filters_by_tag,b);return i(a,c)||3==a.nodeType?void 0:f(r.remove_tags_direct,s[0].nodeName,b)||t.some(function(a){return f(r.remove_tags_deep,a,b)})?void a.remove():f(r.flatten_tags_direct,s[0].nodeName,b)||t.some(function(a){return f(r.flatten_tags_deep,a,b)})?void m(a):f(r.allow_tags_direct,s[0].nodeName,b)||t.some(function(a){return f(r.allow_tags_deep,a,b)})?(a.sanitize_skip_filter_classes||j(a), a.sanitize_skip_filter_attributes||k(a), s.unshift(a), t.unshift(a.nodeName), p(a), s.shift(), void t.shift()):void m(a)}function p(a){var b=['IMG','IFRAME','HR','BR'],c=!0,d=!1,e=void 0;try{for(var f,h,i=g(a)[Symbol.iterator]();!(c=(f=i.next()).done);c=!0)h=f.value, o(h), r.remove_empty&&1==h.nodeType&&!b.includes(h.nodeName)&&0==h.childNodes.length&&h.remove();}catch(a){d=!0, e=a;}finally{try{!c&&i.return&&i.return();}finally{if(d)throw e}}0<r.join_siblings.length&&n(a,r.join_siblings);}if(!(a&&'function'==typeof a.createElement))throw new Error('Need DOM Document interface');if(!(b&&'function'==typeof b.normalize))throw new Error('Need DOM Node interface');r.filters_by_tag||(r.filters_by_tag={}), r.remove_tags_direct||(r.remove_tags_direct={}), r.remove_tags_deep||(r.remove_tags_deep={".*":['style','script','textarea','noscript']}), r.flatten_tags_direct||(r.flatten_tags_direct={}), r.flatten_tags_deep||(r.flatten_tags_deep={}), r.allow_tags_direct||(r.allow_tags_direct={}), r.allow_tags_deep||(r.allow_tags_deep={}), r.allow_attributes_by_tag||(r.allow_attributes_by_tag={}), r.allow_classes_by_tag||(r.allow_classes_by_tag={}), r.join_siblings||(r.join_siblings=[]);var s=[],t=[],u={};s.unshift(b), t.unshift(b.nodeName), 'node'==q?o(b):'children'==q&&p(b);}

function sanitizeNode(a,b){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{};sanitizeDom(a,b,'node',c);}function sanitizeChildNodes(a,b){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{};sanitizeDom(a,b,'children',c);}function sanitizeHtml(a,b){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{};if(!(a&&'function'==typeof a.createElement))throw new Error('Need DOM Document interface');var d=a.implementation.createHTMLDocument('');d.documentElement.innerHTML=b, sanitizeDom(a,d.body,'children',c);var e=[],f=!0,g=!1,h=void 0;try{for(var i,j,k=d.body.childNodes[Symbol.iterator]();!(f=(i=k.next()).done);f=!0)j=i.value, e.push(j);}catch(a){g=!0, h=a;}finally{try{!f&&k.return&&k.return();}finally{if(g)throw h}}return e}

exports.sanitizeDom = sanitizeDom;
exports.sanitizeNode = sanitizeNode;
exports.sanitizeChildNodes = sanitizeChildNodes;
exports.sanitizeHtml = sanitizeHtml;

Object.defineProperty(exports, '__esModule', { value: true });

})));
//# sourceMappingURL=sanitize-dom.umd.min.js.map
